"use client";

import Link from "next/link";
import { useGlobalContext } from "./GlobalContext";
import { useEffect, useState } from "react";

export default function Navbar() {
  const { currentPath, isAuthenticated, userUsername } = useGlobalContext();
  const [blogClassList, setBlogClassList] = useState("link active");
  const [calendarClassList, setCalendarClassList] = useState("link");
  const [inboxClassList, setInboxClassList] = useState("link");
  const [profileClassList, setProfileClassList] = useState("link");
  const [profileLink, setProfileLink] = useState("/login");

  useEffect(() => {
    if (currentPath) {
      // Cette fonction sera appelée à chaque fois que isAuthenticated change
      if (currentPath === "/") {
        setBlogClassList("link active");
        setCalendarClassList("link");
        setInboxClassList("link");
        setProfileClassList("link");
      } else if (currentPath.includes("/calendar")) {
        setCalendarClassList("link active");
        setBlogClassList("link");
        setInboxClassList("link");
        setProfileClassList("link");
      } else if (currentPath.includes("/inbox")) {
        setInboxClassList("link active");
        setCalendarClassList("link");
        setBlogClassList("link");
        setProfileClassList("link");
      } else if (currentPath.includes("/profile")) {
        setProfileClassList("link active");
        setCalendarClassList("link");
        setInboxClassList("link");
        setBlogClassList("link");
      } else if (currentPath.includes("/login")) {
        setProfileClassList("link active");
        setCalendarClassList("link");
        setInboxClassList("link");
        setBlogClassList("link");
      } else if (currentPath.includes("/signup")) {
        setProfileClassList("link active");
        setCalendarClassList("link");
        setInboxClassList("link");
        setBlogClassList("link");
      } else {
        setBlogClassList("link");
        setCalendarClassList("link");
        setInboxClassList("link");
        setProfileClassList("link");
      }
    }
  }, [currentPath]);

  useEffect(() => {
    // Cette fonction sera appelée à chaque fois que isAuthenticated change
    if (isAuthenticated) {
      setProfileLink(`/profile/${userUsername}`);
    } else {
      setProfileLink("/login");
    }
  }, [isAuthenticated, userUsername]);

  return (
    <nav>
      <ul className="links">
        <li>
          <Link href="/" className={blogClassList} title="Access the home page">
            <svg
              width="35"
              height="35"
              viewBox="0 0 35 35"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M17.1133 12.0436L7.77815 19.7321V28.0303C7.77815 28.2452 7.8635 28.4512 8.01543 28.6032C8.16736 28.7551 8.37342 28.8405 8.58827 28.8405L14.2622 28.8258C14.4763 28.8247 14.6813 28.7389 14.8324 28.5871C14.9835 28.4353 15.0682 28.2298 15.0682 28.0156V23.1696C15.0682 22.9547 15.1536 22.7487 15.3055 22.5968C15.4575 22.4448 15.6635 22.3595 15.8784 22.3595H19.1189C19.3337 22.3595 19.5398 22.4448 19.6917 22.5968C19.8436 22.7487 19.929 22.9547 19.929 23.1696V28.0121C19.9286 28.1187 19.9494 28.2243 19.9899 28.3229C20.0305 28.4215 20.0901 28.5111 20.1654 28.5866C20.2406 28.6621 20.33 28.722 20.4285 28.7628C20.527 28.8037 20.6325 28.8248 20.7391 28.8248L26.411 28.8405C26.6258 28.8405 26.8319 28.7551 26.9838 28.6032C27.1357 28.4512 27.2211 28.2452 27.2211 28.0303V19.7266L17.888 12.0436C17.7783 11.9551 17.6416 11.9069 17.5006 11.9069C17.3597 11.9069 17.223 11.9551 17.1133 12.0436ZM31.8591 17.2694L27.6262 13.7803V6.76714C27.6262 6.60599 27.5621 6.45145 27.4482 6.33751C27.3343 6.22356 27.1797 6.15955 27.0186 6.15955H24.1831C24.022 6.15955 23.8675 6.22356 23.7535 6.33751C23.6396 6.45145 23.5755 6.60599 23.5755 6.76714V10.4436L19.0424 6.71397C18.6074 6.35599 18.0615 6.16026 17.4981 6.16026C16.9347 6.16026 16.3888 6.35599 15.9538 6.71397L3.13716 17.2694C3.07564 17.3202 3.02473 17.3827 2.98736 17.4532C2.94999 17.5238 2.92688 17.601 2.91936 17.6804C2.91184 17.7599 2.92005 17.8401 2.94352 17.9164C2.96699 17.9926 3.00526 18.0636 3.05615 18.1251L4.34728 19.6947C4.39803 19.7564 4.46045 19.8075 4.53098 19.845C4.6015 19.8826 4.67873 19.9059 4.75826 19.9135C4.83779 19.9212 4.91805 19.9131 4.99445 19.8897C5.07085 19.8663 5.14188 19.8281 5.20348 19.7772L17.1133 9.96763C17.223 9.87919 17.3597 9.83096 17.5006 9.83096C17.6416 9.83096 17.7783 9.87919 17.888 9.96763L29.7983 19.7772C29.8598 19.8281 29.9307 19.8664 30.007 19.8898C30.0833 19.9133 30.1635 19.9215 30.2429 19.914C30.3224 19.9065 30.3996 19.8834 30.4701 19.846C30.5407 19.8086 30.6031 19.7577 30.654 19.6962L31.9451 18.1266C31.996 18.0647 32.0341 17.9934 32.0573 17.9168C32.0805 17.8402 32.0883 17.7597 32.0803 17.6801C32.0723 17.6004 32.0486 17.5231 32.0107 17.4526C31.9727 17.3822 31.9212 17.3199 31.8591 17.2694Z"
                fill="#FFD68B"
              />
            </svg>
          </Link>
        </li>
        <li>
          <Link
            href="/calendar"
            className={calendarClassList}
            title="Access the calendar page"
          >
            <svg
              width="36"
              height="35"
              viewBox="0 0 36 35"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M13.9483 19.3229H11.6697C11.2937 19.3229 10.9861 19.0153 10.9861 18.6393V16.3607C10.9861 15.9847 11.2937 15.6771 11.6697 15.6771H13.9483C14.3243 15.6771 14.6319 15.9847 14.6319 16.3607V18.6393C14.6319 19.0153 14.3243 19.3229 13.9483 19.3229ZM20.1007 18.6393V16.3607C20.1007 15.9847 19.7931 15.6771 19.4171 15.6771H17.1384C16.7625 15.6771 16.4548 15.9847 16.4548 16.3607V18.6393C16.4548 19.0153 16.7625 19.3229 17.1384 19.3229H19.4171C19.7931 19.3229 20.1007 19.0153 20.1007 18.6393ZM25.5694 18.6393V16.3607C25.5694 15.9847 25.2618 15.6771 24.8858 15.6771H22.6072C22.2312 15.6771 21.9236 15.9847 21.9236 16.3607V18.6393C21.9236 19.0153 22.2312 19.3229 22.6072 19.3229H24.8858C25.2618 19.3229 25.5694 19.0153 25.5694 18.6393ZM20.1007 24.1081V21.8294C20.1007 21.4535 19.7931 21.1459 19.4171 21.1459H17.1384C16.7625 21.1459 16.4548 21.4535 16.4548 21.8294V24.1081C16.4548 24.4841 16.7625 24.7917 17.1384 24.7917H19.4171C19.7931 24.7917 20.1007 24.4841 20.1007 24.1081ZM14.6319 24.1081V21.8294C14.6319 21.4535 14.3243 21.1459 13.9483 21.1459H11.6697C11.2937 21.1459 10.9861 21.4535 10.9861 21.8294V24.1081C10.9861 24.4841 11.2937 24.7917 11.6697 24.7917H13.9483C14.3243 24.7917 14.6319 24.4841 14.6319 24.1081ZM25.5694 24.1081V21.8294C25.5694 21.4535 25.2618 21.1459 24.8858 21.1459H22.6072C22.2312 21.1459 21.9236 21.4535 21.9236 21.8294V24.1081C21.9236 24.4841 22.2312 24.7917 22.6072 24.7917H24.8858C25.2618 24.7917 25.5694 24.4841 25.5694 24.1081ZM31.0382 9.2969V29.349C31.0382 30.8586 29.8134 32.0834 28.3038 32.0834H8.25171C6.74211 32.0834 5.51733 30.8586 5.51733 29.349V9.2969C5.51733 7.78729 6.74211 6.56252 8.25171 6.56252H10.9861V3.60028C10.9861 3.2243 11.2937 2.91669 11.6697 2.91669H13.9483C14.3243 2.91669 14.6319 3.2243 14.6319 3.60028V6.56252H21.9236V3.60028C21.9236 3.2243 22.2312 2.91669 22.6072 2.91669H24.8858C25.2618 2.91669 25.5694 3.2243 25.5694 3.60028V6.56252H28.3038C29.8134 6.56252 31.0382 7.78729 31.0382 9.2969ZM28.3038 29.0072V12.0313H8.25171V29.0072C8.25171 29.1952 8.40552 29.349 8.59351 29.349H27.962C28.15 29.349 28.3038 29.1952 28.3038 29.0072Z"
                fill="#FFD68B"
              />
            </svg>
          </Link>
        </li>
        <li>
          <Link
            href="/inbox"
            className={inboxClassList}
            title="Access the inbox page"
          >
            <svg
              width="36"
              height="35"
              viewBox="0 0 36 35"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M32.2307 16.8877L26.879 8.86008C26.657 8.52715 26.3563 8.25417 26.0035 8.06537C25.6507 7.87657 25.2568 7.77778 24.8566 7.77777H11.2545C10.8544 7.77777 10.4604 7.87656 10.1077 8.06536C9.75486 8.25417 9.45415 8.52715 9.23219 8.86008L3.88046 16.8877C3.61427 17.2869 3.47222 17.756 3.47223 18.2359L3.47223 24.7917C3.47223 26.134 4.56041 27.2222 5.90278 27.2222H30.2083C31.5507 27.2222 32.6389 26.134 32.6389 24.7917V18.2359C32.6389 17.756 32.4969 17.2869 32.2307 16.8877ZM11.6881 11.0185H24.4231L28.744 17.5H22.5116L20.8912 20.7407H15.2199L13.5995 17.5H7.36709L11.6881 11.0185Z"
                fill="#FFD68B"
              />
            </svg>
          </Link>
        </li>
        <li>
          <Link
            href={profileLink}
            className={profileClassList}
            title="Access the profile page"
          >
            <svg
              width="35"
              height="35"
              viewBox="0 0 35 35"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M22.6041 20.2344C20.9692 20.2344 20.1831 21.1459 17.5 21.1459C14.8169 21.1459 14.0364 20.2344 12.3958 20.2344C8.16893 20.2344 4.73956 23.6638 4.73956 27.8906V29.349C4.73956 30.8586 5.96434 32.0834 7.47394 32.0834H27.526C29.0356 32.0834 30.2604 30.8586 30.2604 29.349V27.8906C30.2604 23.6638 26.831 20.2344 22.6041 20.2344ZM27.526 29.349H7.47394V27.8906C7.47394 25.1791 9.68422 22.9688 12.3958 22.9688C13.2275 22.9688 14.5776 23.8802 17.5 23.8802C20.4451 23.8802 21.7667 22.9688 22.6041 22.9688C25.3157 22.9688 27.526 25.1791 27.526 27.8906V29.349ZM17.5 19.3229C22.0288 19.3229 25.7031 15.6486 25.7031 11.1198C25.7031 6.591 22.0288 2.91669 17.5 2.91669C12.9712 2.91669 9.29685 6.591 9.29685 11.1198C9.29685 15.6486 12.9712 19.3229 17.5 19.3229ZM17.5 5.65106C20.5135 5.65106 22.9687 8.1063 22.9687 11.1198C22.9687 14.1333 20.5135 16.5886 17.5 16.5886C14.4865 16.5886 12.0312 14.1333 12.0312 11.1198C12.0312 8.1063 14.4865 5.65106 17.5 5.65106Z"
                fill="#FFD68B"
              />
            </svg>
          </Link>
        </li>
      </ul>
    </nav>
  );
}
